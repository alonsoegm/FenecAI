# ü¶ä FenecAI ‚Äî Azure-Powered Generative AI Platform

> _‚ÄúMerging technology and consciousness to build meaningful AI solutions.‚Äù_

FenecAI is a **comprehensive Generative AI API** built with **.NET 8** and **Azure OpenAI**, aligned with the **Microsoft Certified: Azure AI Engineer Associate (AI-102)** objectives.

FenecAI aggregates capabilities such as:

- üß† Chat Completions (GPT-4) ‚Äî Conversational AI with contextual understanding.

- üß© RAG (Retrieval-Augmented Generation) ‚Äî Contextual answers grounded in your documents.

- üîç Embeddings & Semantic Similarity ‚Äî Vector generation and cosine similarity comparison.

- üé® Image Generation (DALL¬∑E 3) ‚Äî Create images from text prompts and store in Azure Blob.

- üñºÔ∏è Image Analysis (Azure AI Vision) ‚Äî Visual tag extraction, captioning, object detection & OCR.

- üßæ Document Intelligence (Form Recognizer) ‚Äî Read, parse, and extract structured data from files (OCR, Invoices, Layout).

- üó£Ô∏è Speech Service (Text ‚Üî Speech) ‚Äî Convert text or SSML to speech and transcribe audio to text.

- üß© Language Understanding (Azure Language Service) ‚Äî Detect language, extract key phrases, entities, sentiment, and summaries.

- ‚ùì QnA (Conversational Language Understanding) ‚Äî Ask and retrieve answers from a trained knowledge base.

- üõ°Ô∏è Content Safety (Text & Image) ‚Äî Detect unsafe, offensive, or inappropriate content.

- üìä Token Usage & Cost Metrics ‚Äî Track token consumption, request latency, and API cost estimation.

- üìÅ File Upload & Blob Storage Integration ‚Äî Upload and manage raw data and generated content.

---

## üß≠ Architecture Overview

```mermaid

graph TD
U["User / API Client"] --> A["FenecAI.API (.NET)"]

A --> B1["Azure OpenAI (Chat / Embeddings / DALL¬∑E)"]
A --> B2["Azure AI Search (Vector Index)"]
A --> B3["Azure Blob Storage"]
A --> B4["Azure AI Content Safety"]
A --> B5["Azure AI Vision"]
A --> B6["Azure AI Language Service"]
A --> B7["Azure Document Intelligence"]
A --> B8["Azure Speech Service"]
A --> B9["Azure QnA (Conversational Language Understanding)"]
A --> B10["Application Insights"]

B3 --> B2
B2 --> B1
B1 --> B4
B5 --> B4
B6 --> B4
B7 --> B4
B8 --> B4





```


Design Principles

- Interface-based services: Each domain logic is abstracted behind an interface.
- Dependency Injection: All services registered via DI.
- Async/await everywhere: For scalability and non-blocking I/O.
- Separation of concerns: Controllers are thin; heavy lifting done in services.
- Clean architecture-ready: Easy to test, mock, extend, maintain.

---
## ‚òÅÔ∏è Azure Resources Required
To deploy and run FenecAI successfully, create the following Azure resources:

| **Service**                                                | **Resource Type**                      | **Purpose**                                                                  | **Example Name** |
| ---------------------------------------------------------- | -------------------------------------- | ---------------------------------------------------------------------------- | ---------------- |
| üß† **Azure OpenAI**                                        | `Microsoft.CognitiveServices/accounts` | Provides GPT-4, Embeddings, and DALL¬∑E models.                               | `fenecfoundry`   |
| üîç **Azure AI Search**                                     | `Microsoft.Search/searchServices`      | Hosts vector index for semantic RAG.                                         | `fenec-search`   |
| üì¶ **Azure Storage Account**                               | `Microsoft.Storage/storageAccounts`    | Stores raw documents, images, and ingested data.                             | `fenecstorageai` |
| üõ°Ô∏è **Azure AI Content Safety**                            | `Microsoft.CognitiveServices/accounts` | Filters unsafe content for text and images.                                  | `fenec-safety`   |
| üß† **Azure AI Vision**                                     | `Microsoft.CognitiveServices/accounts` | Performs image analysis, captioning, object detection, and OCR.              | `fenec-vision`   |
| üßæ **Azure AI Document Intelligence**                      | `Microsoft.CognitiveServices/accounts` | Extracts text, layout, and structured data (Invoices, Tables, Forms).        | `fenec-docintel` |
| üß© **Azure AI Language**                                   | `Microsoft.CognitiveServices/accounts` | Handles language detection, sentiment, entity extraction, and summarization. | `fenec-language` |
| üó£Ô∏è **Azure Speech Service**                               | `Microsoft.CognitiveServices/accounts` | Converts text or SSML to speech and transcribes audio to text.               | `fenec-speech`   |
| ‚ùì **Azure AI QnA (Conversational Language Understanding)** | `Microsoft.CognitiveServices/accounts` | Enables question-answering with trained knowledge bases.                     | `fenec-qna`      |
| üìà **Application Insights**                                | `Microsoft.Insights/components`        | Provides telemetry, tracing, and performance monitoring.                     | `fenec-insights` |




---

## üß© Required Deployments in Azure OpenAI:

| **Deployment Name**        | **Model**              | **Purpose**                                                                             |
| -------------------------- | ---------------------- | --------------------------------------------------------------------------------------- |
| `gpt-4.1`                  | **GPT-4 Turbo**        | Chat, RAG completions, summarization, reasoning, and natural language generation.       |
| `text-embedding-3-large`   | **Embeddings (Large)** | High-accuracy vector generation for semantic similarity and search indexing.            |
| `text-embedding-3-small`   | **Embeddings (Small)** | Lightweight embedding generation optimized for cost and performance.                    |
| `dall-e-3`                 | **DALL¬∑E 3**           | Image generation from text prompts.                                                     |
| `gpt-4o-mini` *(optional)* | **GPT-4o Mini**        | Lightweight multimodal model for faster responses and lower cost in non-critical tasks. |


---

## ‚öôÔ∏è Configuration ‚Äî appsettings.json

Before running the API, configure the following keys:

```bash
{
  "AzureOpenAI": {
    "Endpoint": "https://YOUR-OPENAI-RESOURCE.cognitiveservices.azure.com/",
    "ApiKey": "YOUR_OPENAI_KEY",
    "Deployment": "gpt-4.1",
    "EmbeddingDeployment": "text-embedding-3-large",
    "ImageDeployment": "dall-e-3"
  },
  "AzureStorage": {
    "ConnectionString": "YOUR_STORAGE_CONNECTION_STRING",
    "ContainerName": "data",
    "DalleContainer": "images"
  },
  "AzureAI": {
    "SearchEndpoint": "https://YOUR-SEARCH-RESOURCE.search.windows.net",
    "SearchApiKey": "YOUR_SEARCH_KEY",
    "SearchIndexName": "documents-index",
    "DocumentEndpoint": "https://YOUR-COGNITIVE-RESOURCE.cognitiveservices.azure.com/",
    "DocumentApiKey": "YOUR_COGNITIVE_KEY",
    "LanguageEndpoint": "https://YOUR-COGNITIVE-RESOURCE.cognitiveservices.azure.com/",
    "LanguageApiKey": "YOUR_COGNITIVE_KEY",
    "QnAProjectName": "FenecAI-QnA",
    "QnADeploymentName": "fenecai-qna-prod"
  },
  "AzureContentSafety": {
    "Endpoint": "https://YOUR-SAFETY-RESOURCE.cognitiveservices.azure.com/",
    "ApiKey": "YOUR_SAFETY_KEY"
  },
  "AzureSpeech": {
    "CognitiveEndpoint": "https://YOUR-COGNITIVE-RESOURCE.cognitiveservices.azure.com/",
    "CognitiveKey": "YOUR_SPEECH_KEY"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}

```

‚ö†Ô∏è Important:
Add appsettings.json to .gitignore so credentials are never pushed to GitHub.

---

## üß† Core API Endpoints

| **Module**          | **HTTP Method** | **Endpoint**                      | **Description**                                                    |
| ------------------- | --------------- | --------------------------------- | ------------------------------------------------------------------ |
| üí¨ Chat             | POST            | `/api/Chat/complete`              | Generate chat completions using GPT-4.                             |
| üß© RAG              | POST            | `/api/RAG/query`                  | Answer questions using document context.                           |
| üß© RAG              | POST            | `/api/RAG/ingest`                 | Index documents from Blob Storage for retrieval.                   |
| üß¨ Embeddings       | POST            | `/api/Embeddings/generate`        | Generate embedding vector from text.                               |
| üß¨ Embeddings       | POST            | `/api/Embeddings/similarity`      | Compute cosine similarity between texts.                           |
| üé® Image            | POST            | `/api/Image/generate`             | Generate image from text prompt (DALL¬∑E 3).                        |
| üé® Image            | POST            | `/api/Image/generate-and-save`    | Generate image and store in Azure Blob Storage.                    |
| üß† Image Analysis   | POST            | `/api/ImageAnalysis/analyze`      | Analyze an image and extract visual tags using Azure AI Vision.    |
| üß† Image Analysis   | POST            | `/api/ImageAnalysis/caption`      | Generate a caption describing the content of an image.             |
| üß† Image Analysis   | POST            | `/api/ImageAnalysis/objects`      | Detect objects within an image using Azure AI Vision.              |
| üß† Image Analysis   | POST            | `/api/ImageAnalysis/ocr`          | Extract text from an image using Azure AI Vision OCR.              |
| üßæ Document OCR     | POST            | `/api/document/read`              | Extract text from documents via Azure Document Intelligence (OCR). |
| üßæ Document Invoice | POST            | `/api/document/invoice`           | Parse invoice fields using prebuilt Invoice model.                 |
| üßæ Document Layout  | POST            | `/api/document/layout`            | Extract layout structure (tables, paragraphs, figures).            |
| üó£Ô∏è Speech TTS      | POST            | `/api/speech/text-to-speech-file` | Convert plain text to downloadable audio file.                     |
| üó£Ô∏è Speech SSML     | POST            | `/api/speech/ssml-to-speech`      | Convert SSML (XML) to audio using Azure Speech Service.            |
| üó£Ô∏è Speech STT      | POST            | `/api/speech/speech-to-text`      | Transcribe speech from uploaded audio (Speech ‚Üí Text).             |
| üß© Language         | POST            | `/api/language/detect`            | Detect the dominant language of a text.                            |
| üß© Language         | POST            | `/api/language/key-phrases`       | Extract key phrases from a text.                                   |
| üß© Language         | POST            | `/api/language/sentiment`         | Analyze sentiment (positive, neutral, negative).                   |
| üß© Language         | POST            | `/api/language/entities`          | Extract named entities (people, organizations, locations).         |
| üß© Language         | POST            | `/api/language/summarize`         | Generate a summary of long text content.                           |
| üí¨ QnA              | POST            | `/api/qna/ask`                    | Ask a question and retrieve answers from knowledge base.           |
| üõ°Ô∏è Safety          | POST            | `/api/ContextSafety/analyze`      | Analyze text for unsafe or harmful content.                        |
| üõ°Ô∏è Safety          | POST            | `/api/ContextSafety/image`        | Analyze uploaded images for content safety.                        |
| üìä Metrics          | POST            | `/api/Metrics/tokens`             | Measure token usage, cost, and latency.                            |
| üìÅ File             | POST            | `/api/File/upload`                | Upload documents to Azure Blob Storage.                            |



---

## üîÅ RAG (Retrieval-Augmented Generation) Flow

```mermaid
sequenceDiagram
    participant U as User
    participant API as FenecAI API
    participant Blob as Azure Blob Storage
    participant Search as Azure AI Search
    participant GPT as Azure OpenAI (GPT-4)

    U->>API: Upload .txt documents
    API->>Blob: Store documents in container
    API->>Search: Split, embed & index chunks
    U->>API: Ask a question
    API->>Search: Vector similarity search
    Search->>API: Return top relevant chunks
    API->>GPT: Combine context + question
    GPT-->>API: Grounded answer
    API-->>U: Final response with sources
```
üß† Workflow / RAG Flow (Query-Time)

- Document ingestion: Upload via /api/rag/ingest ‚Üí store in Blob ‚Üí split ‚Üí embed ‚Üí index in Search.
- Question: Call /api/rag/query with a prompt.
- Search backend: Use vector search in Cognitive Search ‚Üí retrieve top chunks.
- OpenAI: Combine chunks + question ‚Üí call GPT ‚Üí get grounded answer.
- Return: Answer + relevant source links.
---

## üöÄ Running Locally
Prerequisites

- .NET 8 SDK
- Azure Subscription with required Cognitive Services
- Azure CLI or Portal access
- Visual Studio 2022 / VS Code

---

##  Run Instructions

#### 1Ô∏è‚É£ Restore dependencies
```bash
dotnet restore
```

#### 2Ô∏è‚É£ Build solution
```bash
dotnet build
```

#### 3Ô∏è‚É£ Run API locally
```bash
dotnet run
```

####  Then open:

üîó https://localhost:7131/swagger/index.html

You‚Äôll see the interactive Swagger UI, complete with summaries, request schemas, and example payloads.


### üìä Example: RAG Query Flow

1- Upload your .txt documents to the Blob Storage container.

2- Call /api/RAG/ingest ‚Äî chunks, embeds, and indexes documents.

3- Ask a question via /api/RAG/query, e.g.:

```bash
{
  "question": "What are the core values of FenecAI?"
}
```

### ‚úÖ Returns a semantically grounded answer and the contextual sources used

#### üíé Quality and Design Highlights

- SOLID-based architecture for maintainability
- Dependency Injection for modularity and testing
- Strict typing (no weak types or any)
- Async-await throughout for non-blocking I/O
- Comprehensive logging for observability
- Responsible AI enforcement via Content Safety

  ---

üõ°Ô∏è **Recommendations & Best Practices**

- Never commit secrets: use .gitignore and environment variables.
- Enable logging & telemetry: Application Insights integration must be set before production.
- Use interfaces: every service is behind an interface ‚Äî better testing and modularity.
- Validate inputs strictly: e.g., only allow WAV format in Speech-to-Text.
- Modular architecture: you can ship or disable modules independently (Chat, Document, Speech, QnA).
- Retry & exception handling: use policies (e.g. Polly) for transient failures when calling Azure services.

---
### üß†  Why FenecAI Matters

FenecAI was designed not just as a project, but as a statement of craftsmanship.
It reflects years of software engineering discipline ‚Äî merging technical mastery, ethical AI design, and clean architecture into one unified system.

> **‚ÄúDiscipline, clarity, and excellence ‚Äî every line of code is a reflection of mindset.‚Äù**

### üìú License

This project is released under the MIT License.

## üë§ Author

Alonso Gallegos
Senior Software Engineer | Azure AI Engineer

üìç Costa Rica
üíº GitHub ‚Äì alonsoegm

> üåê ‚ÄúEngineering with purpose, discipline, and conscience.‚Äù
















